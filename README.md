# emoji52py

Emoji Art Generator (Python + FastAPI). Upload an image, crop it, convert to an emoji mosaic, and export as text/PNG/JPG.

## Features
- Server-side emoji matching (Lab + edge density + alpha)
- Deterministic output option
- Standardized emoji assets (Twemoji PNGs)
- PNG/JPG export with background handling
- Cache-backed conversion + export pipeline

## Requirements
- Python 3.11+
- macOS/Linux (Windows works with minor path tweaks)

## Setup
```bash
python3 -m venv .venv
.venv/bin/python -m pip install -r requirements.txt
```

### Download Twemoji assets + build dataset
```bash
PYTHONPATH=. .venv/bin/python scripts/download_twemoji_assets.py --clean
PYTHONPATH=. .venv/bin/python scripts/build_emoji_dataset.py
```

## Run
```bash
./start.sh
```
Open `http://127.0.0.1:8200`.

## Tests
```bash
PYTHONPATH=. .venv/bin/python -m pytest
```

## Demo (Pearl Image)
Below is the example emoji mosaic from `pearl-image.txt`:

```
⬛⬛⬛⬛⬛⬛⬛⬛⬛⬛⬛🧔🏿‍♀️🧔🏿‍♀️🧛🏻‍♀️👶🏻🗂👰🏼‍♀️🗂🦪👨🏽‍🏫🙍🏼‍♀️🇮🇷🇲🇬🧖🔑👩🏿‍🦱🧔🏿‍♀️🧔🏿‍♀️⬛⬛⬛⬛
⬛⬛⬛⬛⬛⬛⬛⬛🧔🏿‍♀️⬛🤦🏿‍♀️🇧🇶👚🇺🇾🇸🇻🇸🇻🍆🧙‍♀️🗂🏼🦸🧑🏼‍🎨🧉🤲🏾👩‍🎨👸🏿🧔🏿‍♀️🧔🏿‍♀️🧔🏿‍♀️⬛⬛⬛
⬛⬛⬛⬛⬛⬛⬛⬛🍆🇮🇱🇮🇱🇮🇱🎇🇸🇻🇸🇻🇸🇻🇲🇵🇽🇰🇳🇷🧙🏽‍♀️👶🏼🇮🇷🧑🏾‍🎨🧛🏽‍♂️👴🏿🤲🏾👸🏿🧔🏿‍♀️🧔🏿‍♀️⬛⬛🧔🏿‍♀️
⬛⬛⬛⬛⬛⬛⬛🍆🇮🇱🇮🇱🇮🇱🇮🇱🛅🇸🇻🇸🇻🇸🇻🇸🇻🇲🇵🇽🇰🇪🇺🇳🇷👩🏽‍🤝‍👨🏻🇲🇬🦹🏿‍♂️🧛🏽‍♀️👸🏿🦹🏿🧔🏿‍♀️🧔🏿‍♀️⬛⬛⬛
⬛⬛⬛⬛⬛🧔🏿‍♀️🍆🇮🇱🇮🇱🇮🇱🇮🇱🇮🇱🛗🇸🇻🇸🇻🇸🇻🇸🇻🇲🇵🇲🇵🇲🇵🇳🇷🇳🇷👫🏿🧛🏼‍♂️👸🏿👩🏿‍🦱🧑🏿‍🎨🧔🏿‍♀️🧔🏿‍♀️⬛⬛⬛
⬛⬛⬛⬛⬛🎩🇮🇱🇮🇱🇮🇱👔👔🇮🇱🇸🇻🇸🇻🇸🇻🇸🇻🇸🇻🇲🇵🇲🇵🇲🇵🇳🇷🇳🇷⬛💇🏿‍♀️🧛🏿‍♀️🧔🏿‍♀️🫅🏾🧔🏿‍♀️🧔🏿‍♀️🧔🏿‍♀️⬛⬛
⬛⬛⬛⬛⬛🇮🇱🇮🇱🇮🇱🇮🇱🇮🇱💜💜🇸🇻🇸🇻🇸🇻🇸🇻🇲🇵🇸🇻🇲🇵🇽🇰🇳🇷🇳🇷🇳🇷⬛⬛👩🏿👩‍🎨👦🏿🧔🏿‍♀️⬛⬛⬛
⬛⬛🧔🏿‍♀️⬛🎩💜🇺🇾🇮🇱🇮🇱🛄💜💜🇳🇷🇽🇰🇲🇵🇸🇻🇸🇻🇽🇰🇽🇰🇽🇰⬛⬛🇳🇷⬛⬛🧔🏿‍♀️🧑‍💻🦹🏿‍♂️👩🏿‍🦱🧔🏿‍♀️⬛⬛
⬛🧔🏿‍♀️⬛🧔🏿‍♀️🎩📚👰🏽⚾📚🇺🇾🇸🇻🇽🇰🇽🇰🇳🇷🇽🇰🇪🇺🇸🇻🇳🇷🇳🇷🇳🇷🇳🇷⬛⬛⬛⬛⬛🦸👶🏿🧔🏿‍♀️👩🏿‍🦱⬛⬛
⬛🧔🏿‍♀️⬛⬛👩🏻‍🤝‍👩🏾👰🏽‍♂️👰🏽‍♂️👰🏽‍♂️👰🏽🇯🇪🌠🇲🇭🇽🇰🇽🇰⬛🇳🇷🇪🇺🇳🇷⬛⬛🇳🇷🇳🇷⬛⬛⬛⬛🧑🏾‍🎨👶🏿🧔🏿‍♀️👸🏿⬛⬛
⬛🧔🏿‍♀️⬛🧔🏿‍♀️👏🏻👰🏽‍♂️👰🏽‍♂️👰🏽‍♂️👰🏽🇯🇵🇬🇬🧖🏽‍♀️🇨🇼🇽🇰⬛⬛⬛🇳🇷⬛🇳🇷🇳🇷⬛⬛⬛⬛⬛🇸🇩👶🏿🧔🏿‍♀️👸🏿⬛⬛
🧔🏿‍♀️🧔🏿‍♀️🧔🏿‍♀️🦸🏿‍♀️👏🏻👰🏽👰🏼‍♂️👰🏽👏🏻🤡🇬🇬🌅👩🏾‍🎄💇🏿‍♀️⬛⬛⬛⬛⬛⬛⬛⬛⬛⬛⬛⬛🧛🏽‍♀️🦹🏾‍♂️🧔🏿‍♀️👧🏿⬛⬛
⬛⬛⬛👩🏿‍🦱👨🏼‍❤️‍👨🏻👨🏼‍❤️‍👨🏻👰🏽🇯🇪🙅🏼‍♀️🤶🏾🧖🏽👨🏼‍❤️‍👨🏼🧖🏽👩🏾‍🏫💇🏿‍♀️⬛⬛⬛⬛⬛⬛⬛⬛🇳🇷🇳🇷⬛🙎🏿‍♀️🔑🧔🏿‍♀️🧛🏿⬛⬛
🧔🏿‍♀️🧔🏿‍♀️🧔🏿‍♀️🧔🏿‍♀️🖼💇🏿‍♀️👰🏽👰🏾‍♀️👟👨🏼‍❤️‍👨🏿🙅‍♀️🤶🏾🧖🏽🤶🏿💇🏿‍♀️🧔🏿‍♀️⬛⬛⬛⬛⬛⬛⬛⬛⬛⬛💇🏿‍♀️🥩🧔🏿‍♀️🙍🏿🧔🏿‍♀️⬛
🧔🏿‍♀️🧔🏿‍♀️🧔🏿‍♀️🕋🤶🏻👭🏿👰🏽👨🏻‍❤️‍💋‍👨🏻🛹👨🏻‍❤️‍👨🏼☕💇🏿‍♀️👭🏿👩🏾‍🤝‍👩🏿💇🏿‍♀️👩🏿‍🦱🧔🏿‍♀️⬛⬛⬛⬛⬛🇳🇷🇳🇷⬛⬛⬛👫👩🏿‍🦱👦🏿👸🏿⬛
🧔🏿‍♀️🧔🏿‍♀️🧔🏿‍♀️🤹🏾‍♀️👰🏽‍♀️🙋🏼‍♀️👰🏽👩🏾‍🤝‍👩🏽👨🏿‍❤️‍👨🏼🇬🇬🤶🏻🧔🏿‍♀️👩🏿‍🦱👸🏿👸🏿💇🏿‍♀️🧔🏿‍♀️⬛⬛⬛⬛⬛⬛⬛⬛⬛⬛🛖👧🏿👸🏿🦹🏿⬛
🧔🏿‍♀️🧔🏿‍♀️🧔🏿‍♀️👰🏿‍♀️👰🏽👰🏽🇯🇪👩🏽‍🤝‍👩🏾🐵🌅👨🏻‍🦰👭🏾👭🏿🙇🏻🇸🇾💆🏿‍♀️👩🏿‍🦱🧔🏿‍♀️⬛⬛⬛⬛⬛⬛⬛⬛⬛🛖🤌🏾🕋👸🏿⬛
⬛🧔🏿‍♀️🧔🏿‍♀️👩🏽‍💻👰🏽👰🏽👨🏾‍❤️‍👨🏼🧑🏻‍❤️‍💋‍🧑🏿🐶🇬🇬🇬🇬🏴🙋🏼‍♀️🙅‍♀️🦸🏽‍♀️💇🏿‍♀️👩🏿‍🦱👩🏿‍🦱🧔🏿‍♀️⬛⬛⬛⬛⬛⬛⬛🧔🏿‍♀️👫💅👩🏿‍🦱🧛🏿‍♀️⬛
🧔🏿‍♀️🧔🏿‍♀️🧔🏿‍♀️👩🏻‍🤝‍👩🏾👰🏽🇯🇪👭🏾🚱🇪🇬🇬🇬🇬🇬🇬🇬🙋🏼‍♀️👨🏼‍❤️‍👨🏾👩🏿‍🤝‍👩🏾👩🏿‍🦱👩🏿‍🦱👩🏿‍🦱🧔🏿‍♀️🧔🏿‍♀️⬛⬛⬛⬛⬛⬛🧔🏿‍♀️🏴🥩👩🏿‍🦱🧛🏿‍♂️⬛
⬛🧔🏿‍♀️🧔🏿‍♀️👭🏿👰🏽👩🏽‍🏫👩🏻‍❤️‍💋‍👩🏿🚭👨🏿‍❤️‍💋‍👨🏿👨🏼‍❤️‍👨🏼🌅👨🏼‍❤️‍👨🏼🧖🏽👟💆🏿‍♀️👩🏿‍🦱👩🏿‍🦱👩🏿‍🦱👩🏿‍🦱🧔🏿‍♀️🧔🏿‍♀️⬛⬛⬛🧔🏿‍♀️🧔🏿‍♀️🧔🏿‍♀️🧑🏼‍🎨💅🧔🏿‍♀️👨🏾‍🚀⬛
⬛🧔🏿‍♀️🧔🏿‍♀️👩🏿‍🦱👰🏽🪫👩🏿‍❤️‍💋‍👩🏿👩🏿‍❤️‍💋‍👩🏿👩🏿‍❤️‍💋‍👩🏿🙇‍♀️👨🏼‍❤️‍👨🏼👨🏻‍🦰🧑🏻‍🚒🚂💇🏿‍♀️👩🏿‍🦱👩🏿‍🦱👩🏿‍🦱👩🏿‍🦱🧔🏿‍♀️👩🏿‍🦱🧔🏿‍♀️⬛🧔🏿‍♀️🧔🏿‍♀️⬛🧔🏿‍♀️🧑🏽‍🍼🦸‍♀️👩🏿‍🦱👩‍🔬🧔🏿‍♀️
⬛🧔🏿‍♀️⬛🧔🏿‍♀️🇯🇪👰🏽🪷👨🏻‍❤️‍💋‍👨🏿🙇🏻🧖🏽🙇‍♀️👩🏼‍🤝‍👩🏽👄👩🏻‍❤️‍💋‍👩🏿💇🏿‍♀️💇🏿‍♀️💇🏿‍♀️👩🏿‍🦱🧔🏿‍♀️👩🏿‍🦱🧔🏿‍♀️🧔🏿‍♀️⬛⬛⬛⬛🧔🏿‍♀️👫🐯👩🏿‍🦱🧑‍💼🕋
⬛🧔🏿‍♀️🧔🏿‍♀️🧔🏿‍♀️👩🏽‍🤝‍👩🏻🇱🇻🍱👩🏻‍❤️‍💋‍👨🏿👨🏼‍❤️‍👨🏿🙇🏻🤶🏾👟🚂👭🏿👸🏿👸🏿👸🏿👩🏿‍🦱🧔🏿‍♀️🧔🏿‍♀️🧔🏿‍♀️🧔🏿‍♀️🧔🏿‍♀️🧔🏿‍♀️⬛⬛🧔🏿‍♀️🐯😱👸🏿👩🏼‍🍳👩🏿‍🚀
⬛⬛🧔🏿‍♀️🧔🏿‍♀️💇🏿‍♀️❤️‍🩹🎴👩🏿‍❤️‍💋‍👩🏾🚷👩🏻‍❤️‍💋‍👨🏿👩🏽‍🚀🦸🏽‍♀️👭🏿💆🏿‍♀️💆🏿‍♀️👭🏿💆🏿‍♀️👸🏿👩🏿‍🦱👩🏿‍🦱🧔🏿‍♀️🧔🏿‍♀️🧔🏿‍♀️🧔🏿‍♀️⬛⬛🧔🏿‍♀️🛖🌖🦹🏿👳🏻💇🏻
⬛⬛🧔🏿‍♀️🧔🏿‍♀️🧔🏿‍♀️🩰💮🎴📵👨🏼‍❤️‍👨🏿👩🏿‍🎄👩🏿‍🤝‍👩🏽👭🏿💆🏿‍♀️👭🏿👭🏿👭🏿👸🏿👩🏿‍🦱🥡🧔🏿‍♀️🧔🏿‍♀️🧔🏿‍♀️🧔🏿‍♀️🧔🏿‍♀️🧔🏿‍♀️🧔🏿‍♀️🧑🏼‍🎨😷🏿🇺🇦👋🏽
⬛⬛🧔🏿‍♀️🧔🏿‍♀️🧔🏿‍♀️🎎👏🏻👩🏻‍❤️‍💋‍👨🏻👩🏾‍🤝‍👩🏿🫕👟👩🏿‍🤝‍👩🏾👭🏿👩🏿‍🤝‍👩🏾👩🏿‍🤝‍👩🏾👩🏿‍🤝‍👩🏾👸🏿👩🏿‍🦱💇🏿‍♀️💇🏿‍♀️⚫🧔🏿‍♀️🧔🏿‍♀️🧔🏿‍♀️🧔🏿‍♀️⬛🧔🏿‍♀️👩🏽‍🌾🐯🎊🧖🏿👨‍💼
⬛⬛⬛⬛🧔🏿‍♀️👩🏿‍🦱🤡🙋🏼‍♀️👩🏽‍🤝‍👩🏻👩🏿‍🤝‍👩🏾👩🏿‍🤝‍👩🏾👩🏿‍🤝‍👩🏾👩🏿‍🤝‍👩🏾👩🏿‍🤝‍👩🏾👭🏿👸🏿👩🏿‍🦱👩🏿‍🦱💇🏿‍♀️💇🏿‍♀️💇🏿‍♀️🧏🏿‍♀️🙍🏻‍♀️🤰🏽🙋🏾‍♂️🙎🏿‍♀️💇🏿‍♀️💪🏿🐯🤹🏼💅🏿🫥
⬛⬛⬛⬛🧔🏿‍♀️⬛🧔🏿‍♀️🦸🏾‍♀️👩🏿‍🤝‍👩🏻💆🏿‍♀️💇🏿‍♀️💆🏿‍♀️👭🏿💆🏿‍♀️🦹🏿👸🏿🦹🏿🧏🏾‍♀️🧙‍♀️👰🏻‍♀️👰🏻‍♂️👰🏻👰🏻‍♀️🤰🏽🦸🏿🙎🏿‍♀️🧔🏿‍♀️💇🏿🧑‍💻🤹🏼🏿😶‍🌫️
⬛⬛⬛⬛🧔🏿‍♀️⬛⬛🧔🏿‍♀️🧔🏿‍♀️🧔🏿‍♀️⬛🧔🏿‍♀️👩🏻‍🤝‍👩🏼💅🏾🇬🇲👰🏿‍♂️⬜⬜⬜👰🏻‍♂️👨🏾‍💼🚇🧔🏿‍♀️🧔🏿‍♀️🧔🏿‍♀️🧔🏿‍♀️🧔🏿‍♀️🦹🏿‍♂️🧑‍💻🛖💃🏾🧑‍💼
⬛⬛⬛⬛⬛🧔🏿‍♀️⬛⬛⬛⬛⬛⬛🦸🏿‍♀️🇯🇵⬜⬜⬜🀄👩🏻‍🤝‍👩🏿👩🏿‍🦱🧔🏿‍♀️🧔🏿‍♀️🧔🏿‍♀️🧔🏿‍♀️🧔🏿‍♀️🧔🏿‍♀️🧔🏿‍♀️👸🏿👫🤣💃🏾🇧🇬
```
